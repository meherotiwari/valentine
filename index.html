<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Valentile?</title>
  <style>
    :root{
      --bg1:#ffe6ef; --bg2:#fff7fb; --text:#3a0b1a;
      --accent:#ff2d55; --accent2:#ff5a7a;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }
    body{
      overflow:hidden;
      background:radial-gradient(circle at top,var(--bg2),var(--bg1));
      color:var(--text);
      user-select:none;
      -webkit-tap-highlight-color:transparent;
      touch-action:none; /* iOS gesture-safe */
    }

    /* Background hearts layer */
    #bgHearts{
      position:fixed; inset:0;
      pointer-events:none;
      overflow:hidden;
      z-index:0;
    }
    .bgHeart{
      position:absolute;
      opacity:0.40;
      filter: drop-shadow(0 8px 10px rgba(58,11,26,0.12));
      animation: drift linear forwards;
      will-change: transform, opacity;
    }
    @keyframes drift{
      0%   { transform: translate3d(0, 110vh, 0) rotate(0deg) scale(0.9); opacity: 0; }
      10%  { opacity: 0.40; }
      100% { transform: translate3d(0, -130vh, 0) rotate(360deg) scale(1.25); opacity: 0; }
    }

    /* Center question card */
    .center{
      position:fixed; inset:0;
      display:grid; place-items:center;
      padding:24px; text-align:center;
      z-index:1;
      pointer-events:none;
    }
    .card{
      background:rgba(255,255,255,.72);
      border:1px solid rgba(255,45,85,.18);
      backdrop-filter:blur(8px);
      border-radius:22px;
      padding:28px 22px;
      max-width:560px;
      width:min(560px,92vw);
      box-shadow:0 18px 60px rgba(58,11,26,.12);
    }
    h1{ margin:0; font-size:clamp(26px,4.2vw,42px); }

    /* Timer */
    #timerBar{
      position:fixed;
      left:0; right:0; bottom:14px;
      display:flex; justify-content:center;
      z-index:3;
      pointer-events:none;
    }
    #timerPill{
      background: rgba(255,255,255,0.78);
      border: 1px solid rgba(255,45,85,0.18);
      backdrop-filter: blur(8px);
      border-radius: 999px;
      padding: 10px 14px;
      box-shadow: 0 10px 28px rgba(58,11,26,0.10);
      font-weight: 800;
      color: #7a0f2b;
      letter-spacing: 0.2px;
    }
    #timerPill span{ font-variant-numeric: tabular-nums; }

    /* Runaway button */
    #yesBtn{
      position:fixed; left:0; top:0;
      z-index:2;
      border:none;
      border-radius:999px;
      padding:14px 22px;
      font-weight:900;
      font-size:18px;
      color:#fff;
      cursor:pointer;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      box-shadow:0 12px 30px rgba(255,45,85,.35);
      will-change:transform;
      transform:translate3d(0,0,0);
      -webkit-user-select:none;
    }
    #yesBtn:active{ filter:brightness(.95); } /* don't override transform */

    /* Start overlay: only Start button */
    #startOverlay{
      position:fixed; inset:0; z-index:10;
      display:grid; place-items:center;
      background:rgba(255,230,239,.55);
      backdrop-filter:blur(6px);
      padding:24px;
      text-align:center;
    }
    #startBtn{
      border:none;
      border-radius:999px;
      padding:14px 20px;
      font-weight:900;
      font-size:18px;
      color:#fff;
      background:linear-gradient(135deg,var(--accent),var(--accent2));
      box-shadow:0 12px 30px rgba(255,45,85,.25);
      cursor:pointer;
    }

    /* Win overlay */
    #win{
      position:fixed; inset:0;
      display:none;
      place-items:center;
      text-align:center;
      z-index:5;
      background:radial-gradient(circle at top,#fff,#ffe6ef);
    }
    #win .winCard{
      background:rgba(255,255,255,.84);
      border:1px solid rgba(255,45,85,.22);
      backdrop-filter:blur(8px);
      border-radius:22px;
      padding:28px 22px;
      width:min(640px,92vw);
      box-shadow:0 18px 60px rgba(58,11,26,.12);
    }
    #win h2{
      margin:0 0 8px;
      font-size:clamp(22px,4.2vw,40px);
      color:#b3002d;
    }
    #win p{ margin:0; font-size:clamp(14px,2.3vw,18px); opacity:0.85; }

    /* Flowers confetti on win */
    #flowers{ position:fixed; inset:0; pointer-events:none; overflow:hidden; z-index:4; display:none; }
    .flower{
      position:absolute;
      font-size:28px;
      opacity:0.95;
      filter:drop-shadow(0 6px 8px rgba(58,11,26,.18));
      animation: floatUp linear forwards;
      will-change: transform, opacity;
    }
    @keyframes floatUp{
      0%{ transform:translateY(30px) rotate(0) scale(.9); opacity:0; }
      10%{ opacity:1; }
      100%{ transform:translateY(-120vh) rotate(360deg) scale(1.15); opacity:0; }
    }
  </style>
</head>
<body>
  <div id="bgHearts" aria-hidden="true"></div>

  <div class="center">
    <div class="card">
      <h1>Will you be my valentile üíò</h1>
    </div>
  </div>

  <button id="yesBtn" aria-label="Yes button">Yes</button>

  <div id="timerBar">
    <div id="timerPill">Time: <span id="timeText">0.00</span>s</div>
  </div>

  <div id="flowers" aria-hidden="true"></div>

  <div id="win">
    <div class="winCard">
      <h2>Congratulations my love for being my valentine üåπ</h2>
      <p>‚ù§Ô∏è</p>
      <p style="margin-top:10px; font-weight:900; color:#7a0f2b;">
        You caught it in <span id="finalTime">0.00</span>s
      </p>
    </div>
  </div>

  <div id="startOverlay">
    <button id="startBtn">Start</button>
  </div>

<script>
(() => {
  const btn = document.getElementById("yesBtn");
  const win = document.getElementById("win");
  const flowers = document.getElementById("flowers");
  const startOverlay = document.getElementById("startOverlay");
  const startBtn = document.getElementById("startBtn");
  const timeText = document.getElementById("timeText");
  const finalTime = document.getElementById("finalTime");
  const bg = document.getElementById("bgHearts");

  // ---------- Background hearts ----------
  const heartEmojis = ["‚ù§Ô∏è","üíñ","üíó","üíì","üíï","üíò","üíû","üíù"];
  function spawnBgHeart() {
    const el = document.createElement("div");
    el.className = "bgHeart";
    el.textContent = heartEmojis[(Math.random() * heartEmojis.length) | 0];

    el.style.left = (Math.random() * window.innerWidth) + "px";
    el.style.top = (window.innerHeight + 40) + "px";

    el.style.fontSize = (14 + Math.random() * 32) + "px";
    el.style.animationDuration = (5 + Math.random() * 9) + "s";

    bg.appendChild(el);
    el.addEventListener("animationend", () => el.remove());
  }
  for (let i = 0; i < 28; i++) setTimeout(spawnBgHeart, i * 90);
  setInterval(() => { for (let i = 0; i < 4; i++) spawnBgHeart(); }, 650);

  // ---------- Game movement (HARD MODE) ----------
  let x = 0, y = 0;               // button top-left
  let vx = 720, vy = 560;         // HARD base speed
  let lastT = 0;
  let running = false;

  const isTouch = matchMedia("(pointer: coarse)").matches;

  // Fake slowdown -> instant escape state
  let slowActive = false;
  let slowUntil = 0;
  let escapeAt = 0;
  let savedVx = 0, savedVy = 0;

  const bounds = () => {
    const r = btn.getBoundingClientRect();
    const bw = r.width || 120;
    const bh = r.height || 50;
    return {
      maxX: Math.max(0, window.innerWidth - bw),
      maxY: Math.max(0, window.innerHeight - bh),
    };
  };

  const apply = () => { btn.style.transform = `translate3d(${x}px, ${y}px, 0)`; };

  const clamp = () => {
    const b = bounds();
    x = Math.max(0, Math.min(x, b.maxX));
    y = Math.max(0, Math.min(y, b.maxY));
  };

  function hardTurnJitter() {
    // adds unpredictability even without interaction
    if (Math.random() < 0.08) vx *= -1;
    if (Math.random() < 0.08) vy *= -1;
    const a = Math.random() * Math.PI * 2;
    vx += Math.cos(a) * 70;
    vy += Math.sin(a) * 70;
  }

  function tick(t) {
    if (!running) return;

    if (!lastT) lastT = t;
    const dt = Math.min(0.033, (t - lastT) / 1000);
    lastT = t;

    // Handle fake slowdown / escape sequence
    if (slowActive) {
      if (t >= escapeAt) {
        // instant escape burst
        slowActive = false;

        vx = savedVx;
        vy = savedVy;

        const a = Math.random() * Math.PI * 2;
        vx = vx * 2.2 + Math.cos(a) * 520;
        vy = vy * 2.2 + Math.sin(a) * 520;
      } else if (t < slowUntil) {
        // keep it slow during the tease
        // (do nothing; current vx/vy already slowed)
      }
    } else {
      hardTurnJitter();
    }

    const b = bounds();

    x += vx * dt;
    y += vy * dt;

    // bounce
    if (x <= 0) { x = 0; vx = Math.abs(vx); }
    if (x >= b.maxX) { x = b.maxX; vx = -Math.abs(vx); }
    if (y <= 0) { y = 0; vy = Math.abs(vy); }
    if (y >= b.maxY) { y = b.maxY; vy = -Math.abs(vy); }

    apply();
    requestAnimationFrame(tick);
  }

  // Evil flee: sometimes pretends to slow down, then teleports-speed escape
  function flee() {
    if (!running) return;

    const now = performance.now();

    // If already teasing, don't stack
    if (slowActive) return;

    // 45% chance: fake slowdown first
    if (Math.random() < 0.45) {
      slowActive = true;

      // store "real" velocity to restore and burst later
      savedVx = vx;
      savedVy = vy;

      // slow it down briefly to bait the tap
      vx *= 0.25;
      vy *= 0.25;

      slowUntil = now + 180;  // teaser window
      escapeAt = now + 220;   // instant escape shortly after
      return;
    }

    // Otherwise: immediate hard panic
    const speed = Math.hypot(vx, vy);
    const boost = Math.min(1.6, 900 / Math.max(speed, 1));
    vx *= boost; vy *= boost;

    const a = Math.random() * Math.PI * 2;
    vx += Math.cos(a) * 420;
    vy += Math.sin(a) * 420;

    if (Math.random() < 0.35) vx *= -1;
    if (Math.random() < 0.35) vy *= -1;

    // cap
    const cap = 1600;
    const ns = Math.hypot(vx, vy);
    if (ns > cap) { vx = (vx / ns) * cap; vy = (vy / ns) * cap; }
  }

  // Desktop hover
  btn.addEventListener("mouseenter", () => { if (!isTouch) flee(); });

  // Extra evil: proximity panic when pointer gets close
  document.addEventListener("pointermove", (e) => {
    if (!running) return;
    const r = btn.getBoundingClientRect();
    const cx = r.left + r.width / 2;
    const cy = r.top + r.height / 2;
    const dist = Math.hypot(cx - e.clientX, cy - e.clientY);
    if (dist < 150) flee();
  }, { passive: true });

  // Touch: arm flee quickly so it is hard but still winnable
  let timer = null;
  btn.addEventListener("touchstart", (e) => {
    e.preventDefault();
    if (!isTouch) return;
    clearTimeout(timer);
    timer = setTimeout(() => { flee(); timer = null; }, 60); // HARD delay
  }, { passive: false });
  btn.addEventListener("touchend", () => { clearTimeout(timer); timer = null; }, { passive: true });
  btn.addEventListener("touchcancel", () => { clearTimeout(timer); timer = null; }, { passive: true });

  // ---------- Timer ----------
  let startMs = 0;
  let timerInterval = null;

  function startTimer() {
    startMs = performance.now();
    clearInterval(timerInterval);
    timerInterval = setInterval(() => {
      const elapsed = (performance.now() - startMs) / 1000;
      timeText.textContent = elapsed.toFixed(2);
    }, 50);
  }
  function stopTimer() {
    clearInterval(timerInterval);
    const elapsed = (performance.now() - startMs) / 1000;
    timeText.textContent = elapsed.toFixed(2);
    finalTime.textContent = elapsed.toFixed(2);
  }

  // ---------- Win ----------
  btn.addEventListener("click", () => {
    if (!running) return;
    running = false;
    stopTimer();

    btn.style.display = "none";
    win.style.display = "grid";
    flowers.style.display = "block";
    spawnFlowers();
  });

  // Flowers confetti
  const flowerEmojis = ["üåπ","üå∫","üå∑","üíê","‚ù§Ô∏è","üå∏"];
  function spawnOneFlower() {
    const el = document.createElement("div");
    el.className = "flower";
    el.textContent = flowerEmojis[(Math.random() * flowerEmojis.length) | 0];
    el.style.left = (Math.random() * window.innerWidth) + "px";
    el.style.top = (window.innerHeight + 40) + "px";
    el.style.fontSize = (22 + Math.random() * 22) + "px";
    el.style.animationDuration = (3 + Math.random() * 2.5) + "s";
    flowers.appendChild(el);
    el.addEventListener("animationend", () => el.remove());
  }
  function spawnFlowers() {
    for (let i = 0; i < 40; i++) setTimeout(spawnOneFlower, i * 40);
    const interval = setInterval(() => { for (let i = 0; i < 6; i++) spawnOneFlower(); }, 380);
    setTimeout(() => clearInterval(interval), 12000);
  }

  // ---------- Start ----------
  function placeButton() {
    const b = bounds();
    x = b.maxX * 0.5;
    y = b.maxY * 0.68;
    clamp();
    apply();
  }

  function startGame() {
    startOverlay.style.display = "none";
    btn.style.display = "block";

    // reset
    vx = 720; vy = 560;
    slowActive = false; slowUntil = 0; escapeAt = 0;

    placeButton();
    lastT = 0;
    running = true;
    startTimer();
    requestAnimationFrame(tick);
  }

  startBtn.addEventListener("click", startGame);

  window.addEventListener("resize", () => { clamp(); apply(); });

  window.addEventListener("load", () => {
    placeButton();
    timeText.textContent = "0.00";
  });
})();
</script>
</body>
</html>
